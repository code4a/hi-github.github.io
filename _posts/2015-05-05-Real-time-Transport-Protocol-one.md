---
layout: post
title: RTP实时传输协议
categories: [协议]
---

# 实时传输协议

> 实时传输协议RTP（Real-time Transport Protocol）是一个网络传输协议，RTP协议详细说明了在互联网上传递音频和视频的标准数据包格式。它一开始被设计为一个多播协议，但后来被用在很多单播应用中。RTP协议常用于流媒体系统（配合RTSP协议），视频会议和一键通（Push to Talk）系统（配合H.323或SIP），使它成为IP电话产业的技术基础。RTP协议和RTP控制协议RTCP一起使用，而且它是建立在用户数据报协议上的。RTP广泛应用于流媒体相关的通讯和娱乐，包括电话、视频会议、电视和基于网络的一键通业务（类似对讲机的通话）。

### RTP协议定义的两种报文

* **RTP报文** 用于传送媒体数据(如音频/视频)，它由RTP报头和数据两部分组成，RTP数据部分称为有效载荷(payload)；

	报头格式如下图：

	![rtp_baowen_geshi]({{ site.url }}/images/posts/rtp_baowen_geshi_img.png)

	其中：
	
	- V：RTP协议的版本号，占2位，当前协议版本号为2。
	- P：填充标志，占1位，如果P=1，则在该报文的尾部将填充一个或多个额外的八位组，它们不是有效载荷的一部分。
	- X：扩展标志，占1位，如果X=1，则在RTP报头后跟有一个扩展报头。
	- CC：CSRC计数器，占 4位，指示CSRC 标识符的个数。
	- M: 标记，占1位，不同的有效载荷有不同的含义，对于视频，标记一帧的结束；对于音频，标记会话的开始。
	- PT: 有效载荷类型，占7位，用于说明RTP报文中有效载荷的类型，如GSM音频、JPEM图像等。
	- 序列号：占16位，用于标识发送者所发送的RTP报文的序列号，每发送一个报文，序列号增1。接收者通过序列号来检测报文丢失情况，重新排序报文，恢复数据。
	- 时戳 (Timestamp)：占32位，时戳反映了该RTP报文的第一个八位组的采样时刻。接收者使用时戳来计算延迟和延迟抖动，并进行同步控制。
	- 同步信源(SSRC)标识符：占32位，用于标识同步信源。该标识符是随机选择的，参加同一视频会议的两个同步信源不能有相同的SSRC。
	- 特约信源(CSRC)标识符：每个CSRC标识符占32位，可以有0～15个。每个CSRC标识了包含在该RTP报文有效载荷中的所有特约信源。

##

* **RTCP报文** 用于传送控制信息，以实现协议控制功能。 